{% liquid
  assign settings = section.settings
  assign items = section.blocks
  assign product_list = settings.product_list
  assign pc_row = settings.pc_row
  assign mobile_row = settings.mobile_row
  assign bg_color = settings.product_item_bg_color
  assign sale_flag = settings.product_sale_flag
  assign pc_padding = settings.pc_padding
  assign mobile_padding = settings.mobile_padding
  assign need_load_more = settings.need_load_more
  assign load_more_default_count = settings.load_more_default_count
  assign pc_product_sale_width = settings.pc_product_sale_width
  assign mobile_product_sale_width = settings.mobile_product_sale_width
  assign show_sale_flag = settings.show_sale_flag
  assign show_compare = settings.show_compare
  assign show_rating = settings.show_rating
  assign show_learn_btn = settings.show_learn_btn
  assign pc_product_item_img_size = settings.pc_product_item_img_size
  assign mobile_product_item_img_size = settings.mobile_product_item_img_size
  assign mobile_product_type = settings.mobile_product_type
  assign section_id = settings.section_id
%}
<link
  rel="stylesheet"
  href="https://cdn.shopify.com/s/files/1/0257/5246/9566/files/swiper-bundle.min_b4c60233-5e07-47dc-800a-583c16079d0b.css?v=1655275790"
>
<style>
  #{{ section_id }} .ug-product-list {
      margin: 0 auto;
      max-width: 1280px;
      width: 100%;
      padding: {{ pc_padding }};
  }
  #{{ section_id }} .ug-product-list-main {
      display: grid;
      width: 100%;
      grid-template-columns: repeat({{ pc_row }},minmax(0, 1fr));
      gap: 1vw;
      position: relative;
  }
  .load-more__btn {
      color: #00CC88;
      font-size: 1.04vw;
  }
  .load-more__btn-wrap {
      position: absolute;
      bottom: -40px;
      left: 50%;
      transform: translate(-50%, 100%);
  }
  .cursor-btns .cursor-btn {
      padding-bottom: 0.78125vw;
      text-align: center;
      cursor: pointer;
      font-size: 1.042vw;
      border-bottom: 0.052vw solid rgba(0, 0, 0, 0.2);
      transition: all .3s;
  }

  .cursor-btns .cursor-btn:hover,
  .cursor-btns .cursor-btn.swiper-slide-thumb-active {
      border-bottom: 0.052vw solid #00CC88;
      color: #000;
  }
  @media (max-width: 768px) {
      #{{ section_id }} .ug-product-list {
          padding: {{ mobile_padding }};
      }
      #{{ section_id }} .ug-product-list-main {
          grid-template-columns: repeat({{ mobile_row }},minmax(0, 1fr));
          gap: 12px;
          padding: 0 12px;
      }
      .load-more__btn {
          color: #00CC88;
          font-size: 16px;
      }
  }
</style>
<style>
  .ug-product-item {
      position: relative;
      width: 100%;
      padding: 7.28% 9.7%;
      border-radius: 12px;
      overflow: hidden;
  }
  .ug-product-item:hover .ug-product-img > img {
      transform: scale(1.1);
      opacity: .7;
  }
  .ug-product-box {
      width: 100%;
      position: relative;
      height: 100%;
      display: flex;
      flex-direction: column;
  }
  .ug-product-img {
      width: {{ pc_product_item_img_size | default: '50%'}};
      padding-bottom: {{ pc_product_item_img_size | default: '50%'}};
      position: relative;
      margin: 0 auto;
  }
  .ug-product-img > img {
      display: block;
      position: absolute;
      height: 100%;
      width: 100%;
      color: transparent;
      object-fit: contain;
      vertical-align: middle;
      transition: all .3s;
  }
  .ug-product-info {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      flex: 1;
  }
  .ug-product-title {
      font-weight: 400;
      font-size: .833vw;
      color: #666;
      overflow: hidden;
      text-overflow: ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      height: 2.8vw;
      margin: 0.625vw 0 0.833vw;
  }
  .ug-product-price-review {
      display: flex;
      align-items: center;
      justify-content: space-between;
  }
  .ug-product-price {
      font-weight: 600;
      font-size: 1.042vw;
      color: #000;
      margin: 0;
      line-height: 1.5;
  }
  .ug-product-compare_at_price {
      font-weight: 500;
      font-size: .729vw;
      text-decoration-line: line-through;
      color: #a4a4a6;
      padding-left: 0.26vw;
  }
  .ug-product-buy {
      display: flex;
      align-items: self-end;
      justify-content: space-between;
      width: 100%;
      margin-top: 0.625vw;
      gap: 2%;
  }
  .ug-product-buy-btn {
      flex: 1;
      color: #fff;
      font-size: min(.833vw, 16px);
      font-weight: 600;
      border-radius: 3.125vw;
      line-height: 1.1;
      background: #000;
      text-align: center;
      padding: min(.625vw, 12px) 0;
  }
  .ug-product-buy-btn:hover {
      background: #00cc88;
      color: white;
  }
  .ug-product-learn-btn {
      display: inline-block;
      flex: 1;
      color: #333;
      font-weight: 600;
      border-radius: 3.125vw;
      border: 0.104vw solid #333;
      text-align: center;
      font-size: min(.833vw, 16px);
      line-height: 1;
      padding: min(.625vw, 12px) 0;
  }
  .ug-product-learn-btn:hover {
      color: #00cc88;
      border-color: #00cc88;
  }
  .ug-product-sale {
      position: absolute;
      top: -0.208vw;
      left: 0.417vw;
  }
  .ug-product-sale-flag {
      width: {{ pc_product_sale_width | default: '60px' }};
  }
  .ug-product-sale-flag > img {
      display: block;
      width: 100%;
  }
  .ug-product-sale-text {
      font-size: 20px;
      font-weight: 700;
      color: white;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
  }
  .ug-product-sale-text-percent {
      font-size: 14px;
      font-weight: 400;
  }
  @media (max-width: 768px) {
      .ug-product-item {
          padding: 20px 12px;
      }
      .ug-product-img {
          width: {{ mobile_product_item_img_size | default: '57%'}};
          padding-bottom: {{ mobile_product_item_img_size | default: '57%'}};
          position: relative;
          margin: 0 auto;
      }
      .ug-product-title {
          font-size: 12px;
          margin: 10px 0;
          max-height: 42px;
          height: auto;
      }
      .ug-product-price-review {
          display: flex;
          align-items: flex-start;
          justify-content: flex-start;
          flex-direction: column;
      }
      .ug-product-price {
          font-size: 18px;
          line-height: 1.5;
      }
      .ug-product-compare_at_price {
          font-size: 12px;
          padding-left: 8px;
      }
      .ug-product-buy {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: flex-end;
          width: 100%;
          margin-top: 20px;
      }
      .ug-product-buy-btn {
          width: 100%;
          font-size: 14px;
          padding: 8px 0;
          line-height: 1.5;
          text-align: center;
          border-radius: 30px;
      }
      .ug-product-learn-btn {
          width: 100%;
          font-size: 14px;
          padding: 8px 0;
          line-height: 1.5;
          text-align: center;
          margin-top: 8px;
          border-radius: 30px;
      }
      .ug-product-sale {
          position: absolute;
          top: -0.208vw;
          left: 0.417vw;
      }
      .ug-product-sale-flag {
          width: {{ mobile_product_sale_width | default: '48px' }};
      }
      .ug-product-sale-text {
          font-size: 16px;
      }
      .ug-product-sale-text-percent {
          font-size: 12px;
      }
      .xxx .ug-product-box {
          flex-direction: row;
          align-items: center;
      }
      .ug-product-info {
          display: flex;
      }
  }
</style>
<div class="contant">
  <div class="cursor-btns swiper" thumbsslider="">
    <div class="swiper-wrapper">
      <span class="cursor-btn swiper-slide">Compatibility</span>
      <span class="cursor-btn swiper-slide">Ports</span>
    </div>
  </div>
  <div class="tabs_swiper swiper">
    <div class="swiper-wrapper">
      {% for item in items %}
        <div class="ug-product-list swiper-slide" id="{{ section_id }}">
          <div class="ug-product-list-main load-more_list">
            {% for product in product_list %}
              <div class="ug-product-item" style="background: {{ bg_color | default: '#fff' }}">
                <div class="ug-product-box">
                  <a href="{{ product.url }}">
                    <div class="ug-product-img">
                      <img src="{{ product.featured_media | img_url: "400x" }}" alt="{{ product.title }}">
                    </div>
                  </a>
                  <div class="ug-product-info">
                    <a href="{{ product.url }}">
                      <div class="ug-product-title">
                        {{ product.title }}
                      </div>
                    </a>
                    <div class="ug-product-price-review">
                      {% assign compare_at_price = product.compare_at_price %}
                      {% assign price = product.price %}
                      {% assign showDiscountBar = compare_at_price | minus: price %}

                      {% if showDiscountBar > 1 %}
                        <p class="ug-product-price font-lato">
                          {{ product.price | money }}
                          <span class="ug-product-compare_at_price">{{ product.compare_at_price | money }}</span>
                        </p>
                      {% else %}
                        <p class="ug-product-price font-lato">{{ product.price | money }}</p>
                      {% endif %}
                      {% if show_rating %}
                        <div class="ug-product-review">
                          {%- render 'product-rating', product: product, app_review: '4' -%}
                        </div>
                      {% endif %}
                    </div>
                    <div class="ug-product-buy">
                      <a
                        href="{{ product.url }}"
                        class="t4s-pr-item-btn t4s-pr-addtocart buy_now ug-product-buy-btn"
                        data-variant-id="{{ product.variants.first.id }}"
                        data-action-atc
                        rel="nofollow"
                        >Buy Now</a
                      >
                      {% if show_learn_btn %}
                        <a href="{{ product.url }}" class="ug-product-learn-btn">Learn more</a>
                      {% endif %}
                    </div>
                  </div>
                </div>
                {% if showDiscountBar > 1 and show_sale_flag %}
                  <div class="ug-product-sale">
                    <span class="ug-product-sale-text">
                      {{ compare_at_price | minus: price | times: 100 | divided_by: compare_at_price | prepend: '-' -}}
                      <span
                        class="ug-product-sale-text-percent"
                        >%</span
                      >
                    </span>
                    <div class="ug-product-sale-flag">
                      <img src="{{ sale_flag }}" alt="flag">
                    </div>
                  </div>
                {% endif %}
              </div>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script src="https://cdn.shopify.com/s/files/1/0257/5246/9566/files/jquery-1.7.2.min.js?v=1624935298"></script>
<script
  src="https://cdn.shopify.com/s/files/1/0257/5246/9566/files/swiper-bundle.min_23a60c44-0efc-4129-bf9f-c046f688609a.js?v=1655275790"
></script>
<script>
  const cursorBtns = new Swiper(".cursor-btns", {
              slidesPerView: 5,
              watchSlidesVisibility: true //防止不可点击
          });
  const TabsSwiper = new Swiper('.tabs_swiper', {
             slidesPerView: 'auto',
             spaceBetween: 20,
             speed: 1000,
             centeredSlides: true,
             loop: true,
             autoplay: {
                 delay: 5000,
             },
             thumbs: {
                  swiper: cursorBtns,
              },
         })
</script>
{% if need_load_more %}
  <script
    src="https://cdn.shopify.com/s/files/1/0257/5246/9566/files/simpleLoadMore.min.js?v=1680093074"
    defer
  ></script>
  <script>
    
    
    
            $(function () {
                $(`{{ section_id | prepend: '#' }} .load-more_list`).simpleLoadMore({
                    item: `div.ug-product-item`,
                    count: {{ load_more_default_count }},
                    itemsToLoad: -1,
                    btnHTML: `<a href="#" class="load-more__btn">View More <svg class="icon" aria-hidden="true" style="transform: rotate(90deg)">
                <use xlink:href="#icon-xiayiye"></use>
            </svg></a>`
                });
            });



  </script>
{% endif %}

{% schema %}
{
  "name": "UGREEN Tbas Product List",
  "settings": [
    {
      "type": "color",
      "id": "product_item_bg_color",
      "label": "Product Item 背景色",
      "default": "#fff"
    },
    {
      "type": "text",
      "id": "pc_product_item_img_size",
      "label": "电脑端Product Item 图片比例",
      "default": "50%"
    },
    {
      "type": "text",
      "id": "mobile_product_item_img_size",
      "label": "移动端Product Item 图片比例",
      "default": "57%"
    },
  {
      "type": "text",
      "id": "pc_row",
      "label": "电脑端显示几行",
      "default": "4"
    },
    {
      "type": "text",
      "id": "mobile_row",
      "label": "移动端显示几行",
      "default": "2"
    },
    {
      "type": "text",
      "id": "product_sale_flag",
      "label": "折扣背景标识",
      "default": "https://cdn.shopify.com/s/files/1/0257/5246/9566/files/weekly_slae_tag.png?v=1671085492"
    },
    {
      "type": "text",
      "id": "pc_product_sale_width",
      "label": "pc端折扣背景标识大小",
      "default": "60px"
    },
    {
      "type": "text",
      "id": "mobile_product_sale_width",
      "label": "移动端端折扣背景标识大小",
      "default": "48px"
    },
    {
      "type": "text",
      "id": "pc_padding",
      "label": "电脑padding数值",
      "default": "80px 0"
    },
    {
      "type": "text",
      "id": "mobile_padding",
      "label": "移动端padding数值",
      "default": "40px 0"
    },
    {
      "type": "checkbox",
      "id": "need_load_more",
      "label": "是否需要加载更多",
      "default": true
    },
    {
      "type": "number",
      "id": "load_more_default_count",
      "label": "初始展示数量",
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "show_sale_flag",
      "label": "是否展示标识",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_compare",
      "label": "是否展示原价",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_rating",
      "label": "是否展示评分",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_learn_btn",
      "label": "是否展示Learn按钮",
      "default": true
    }
  ],
  "blocks": [
    {
      "name": "Product list Tabs",
      "type": "ug-product-list",
      "settings": [
        {
          "type": "product_list",
          "id": "product_list",
          "label": "商品列表"
        },
        {
          "type": "text",
          "id": "section_id",
          "label": "当前模块Id",
          "info": "用于标识多个 product list 模块，不可重复",
          "default": "ug-product-list"
        }
      ]
    }
  ]
}
{% endschema %}
